<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lottery Optimizer</title>
  <link rel="stylesheet" href="/static/styles.css" />
  <style>
    /* small helper styles to ensure clickable feedback is obvious */
    .btn[disabled] { opacity:.6; cursor:not-allowed; }
    .pill { display:inline-block; padding:2px 8px; border-radius:999px; background:#eef2ff; color:#1e40af; font-size:12px; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }
    .grid { display:grid; gap:16px; }
    .grid-2 { grid-template-columns: 1fr 1fr; }
    .grid-3 { grid-template-columns: 1fr 1fr 1fr; }
    .two-col { display:grid; grid-template-columns: 1fr 1fr; gap:12px; }
    .right { margin-left:auto; }
    .inline { display:flex; align-items:center; gap:12px; }
    .tiny { font-size:12px; color:#666; }
    .batch { max-height:220px; overflow:auto; padding-left:18px; }
    .statline .chip { display:inline-block; padding:2px 6px; border-radius:6px; background:#f1f5f9; margin-right:6px; font-size:12px; }
    .toast { position:fixed; bottom:16px; left:16px; background:#111; color:#fff; padding:10px 14px; border-radius:10px; opacity:.95; z-index:9; }
  </style>
</head>
<body>

  <h1>Lottery Optimizer</h1>

  <!-- BULK IMPORT ------------------------------------------------------->
  <div class="card">
    <div class="inline">
      <div><b>Bulk import history (CSV)</b><br><span class="tiny">Headers: <code>game,draw_date,tier,n1..n6,bonus</code></span></div>
      <label class="right tiny">
        <input type="checkbox" id="overwrite" checked />
        Overwrite existing data
      </label>
      <button id="importBtn" class="btn">Import CSV</button>
    </div>
    <div class="inline" style="gap:8px; margin-top:8px;">
      <input type="file" id="csvFile" />
    </div>
    <pre id="importLog" class="log mono" style="margin-top:8px; min-height:70px;"></pre>
  </div>

  <!-- PHASE 1 ----------------------------------------------------------->
  <div class="card">
    <div class="pill">Phase 1 — Evaluation</div>
    <div class="tiny" style="margin-top:6px;">Choose the 2nd newest jackpots (per-game dates), Retrieve ⇒ verify previews ⇒ Run Phase 1.</div>

    <div class="grid grid-2" style="margin-top:12px;">
      <!-- Left: 2nd Newest dates & previews -->
      <div class="card">
        <div class="pill">The 2nd Newest jackpots — with per-game dates</div>

        <div class="grid grid-2" style="margin-top:10px;">
          <!-- MM -->
          <div>
            <div class="tiny">Mega Millions date</div>
            <div class="inline" style="gap:6px;">
              <input id="mmDate" type="text" placeholder="MM/DD/YYYY" />
              <button id="mmRetrieve" class="btn">Retrieve</button>
            </div>
            <textarea id="mmPreview" class="mono" rows="2" placeholder="[[..mains..], bonus]"></textarea>
          </div>

          <!-- PB -->
          <div>
            <div class="tiny">Powerball date</div>
            <div class="inline" style="gap:6px;">
              <input id="pbDate" type="text" placeholder="MM/DD/YYYY" />
              <button id="pbRetrieve" class="btn">Retrieve</button>
            </div>
            <textarea id="pbPreview" class="mono" rows="2" placeholder="[[..mains..], bonus]"></textarea>
          </div>
        </div>

        <!-- IL dates (JP/M1/M2) -->
        <div class="grid grid-3" style="margin-top:10px;">
          <div>
            <div class="tiny">IL Lotto — Jackpot</div>
            <div class="inline" style="gap:6px;">
              <input id="ilJPDate" type="text" placeholder="MM/DD/YYYY" />
              <button id="ilJPRetrieve" class="btn">Retrieve</button>
            </div>
            <textarea id="ilJPPreview" class="mono" rows="2" placeholder="[[..mains..], null]"></textarea>
          </div>
          <div>
            <div class="tiny">IL Lotto — Million 1</div>
            <div class="inline" style="gap:6px;">
              <input id="ilM1Date" type="text" placeholder="MM/DD/YYYY" />
              <button id="ilM1Retrieve" class="btn">Retrieve</button>
            </div>
            <textarea id="ilM1Preview" class="mono" rows="2" placeholder="[[..mains..], null]"></textarea>
          </div>
          <div>
            <div class="tiny">IL Lotto — Million 2</div>
            <div class="inline" style="gap:6px;">
              <input id="ilM2Date" type="text" placeholder="MM/DD/YYYY" />
              <button id="ilM2Retrieve" class="btn">Retrieve</button>
            </div>
            <textarea id="ilM2Preview" class="mono" rows="2" placeholder="[[..mains..], null]"></textarea>
          </div>
        </div>

        <!-- FEEDS -->
        <div class="grid grid-3" style="margin-top:10px;">
          <textarea id="FEED_MM" class="mono" rows="9" placeholder="FEED_MM — paste latest feed…"></textarea>
          <textarea id="FEED_PB" class="mono" rows="9" placeholder="FEED_PB — paste latest feed…"></textarea>
          <textarea id="FEED_IL" class="mono" rows="9" placeholder="FEED_IL — paste latest feed…"></textarea>
        </div>
      </div>

      <!-- Right: History block loaders (Phase 1 uses 3rd-newest start) -->
      <div class="card">
        <div class="pill">History (use 3rd newest date → “Load 20”)</div>

        <div class="grid grid-2" style="margin-top:8px;">
          <div>
            <div class="tiny">HIST_MM_BLOB start date</div>
            <div class="inline">
              <input id="mmHistDate" type="text" placeholder="MM/DD/YYYY" />
              <button id="mmLoad20" class="btn">Load 20</button>
            </div>
            <textarea id="HIST_MM_BLOB" class="mono" rows="7" placeholder="mm-dd-yy  n1-n2-n3-n4-n5  MB&#10;…"></textarea>
          </div>

          <div>
            <div class="tiny">HIST_PB_BLOB start date</div>
            <div class="inline">
              <input id="pbHistDate" type="text" placeholder="MM/DD/YYYY" />
              <button id="pbLoad20" class="btn">Load 20</button>
            </div>
            <textarea id="HIST_PB_BLOB" class="mono" rows="7" placeholder="mm-dd-yy  n1-n2-n3-n4-n5  PB&#10;…"></textarea>
          </div>
        </div>

        <div class="grid grid-3" style="margin-top:8px;">
          <div>
            <div class="tiny">IL JP start date</div>
            <div class="inline">
              <input id="ilJPHistDate" type="text" placeholder="MM/DD/YYYY" />
              <button id="ilJPLoad20" class="btn">Load 20</button>
            </div>
            <textarea id="HIST_IL_JP_BLOB" class="mono" rows="6" placeholder="mm-dd-yy  A-B-C-D-E-F"></textarea>
          </div>
          <div>
            <div class="tiny">IL M1 start date</div>
            <div class="inline">
              <input id="ilM1HistDate" type="text" placeholder="MM/DD/YYYY" />
              <button id="ilM1Load20" class="btn">Load 20</button>
            </div>
            <textarea id="HIST_IL_M1_BLOB" class="mono" rows="6" placeholder="mm-dd-yy  A-B-C-D-E-F"></textarea>
          </div>
          <div>
            <div class="tiny">IL M2 start date</div>
            <div class="inline">
              <input id="ilM2HistDate" type="text" placeholder="MM/DD/YYYY" />
              <button id="ilM2Load20" class="btn">Load 20</button>
            </div>
            <textarea id="HIST_IL_M2_BLOB" class="mono" rows="6" placeholder="mm-dd-yy  A-B-C-D-E-F"></textarea>
          </div>
        </div>
      </div>
    </div>

    <!-- RUN PHASE 1 -->
    <div class="inline" style="margin-top:12px;">
      <button id="runPhase1" class="btn primary">Run Phase 1</button>
      <span class="tiny">Saved path:</span>
      <input id="phase1Path" type="text" readonly />
      <span id="phase1Done" class="tiny" style="display:none;">Done</span>
    </div>

    <!-- PHASE 1 results -->
    <div id="phase1ResultsRow" class="grid grid-3" style="margin-top:12px;">
      <!-- MM -->
      <div class="card">
        <div class="inline">
          <span class="pill">Mega Millions — 50 rows</span>
          <span id="mmCounts" class="tiny right"></span>
        </div>
        <div class="two-col" style="margin-top:8px">
          <div>
            <div class="tiny">Batch</div>
            <ol id="mmBatch" class="batch mono"></ol>
          </div>
          <div>
            <div class="tiny">Stats</div>
            <div id="mmStats" class="statline" style="margin-bottom:8px"></div>
            <div class="tiny">Row indices</div>
            <pre id="mmRows" class="mono" style="min-height:100px"></pre>
          </div>
        </div>
      </div>
      <!-- PB -->
      <div class="card">
        <div class="inline">
          <span class="pill">Powerball — 50 rows</span>
          <span id="pbCounts" class="tiny right"></span>
        </div>
        <div class="two-col" style="margin-top:8px">
          <div>
            <div class="tiny">Batch</div>
            <ol id="pbBatch" class="batch mono"></ol>
          </div>
          <div>
            <div class="tiny">Stats</div>
            <div id="pbStats" class="statline" style="margin-bottom:8px"></div>
            <div class="tiny">Row indices</div>
            <pre id="pbRows" class="mono" style="min-height:100px"></pre>
          </div>
        </div>
      </div>
      <!-- IL -->
      <div class="card">
        <div class="inline">
          <span class="pill">IL Lotto — 50 rows</span>
          <span id="ilCounts" class="tiny right"></span>
        </div>
        <div class="two-col" style="margin-top:8px">
          <div>
            <div class="tiny">Batch</div>
            <ol id="ilBatch" class="batch mono"></ol>
          </div>
          <div>
            <div class="tiny">Stats</div>
            <div id="ilStats" class="statline" style="margin-bottom:8px"></div>
            <div class="tiny">Row indices</div>
            <pre id="ilRows" class="mono" style="min-height:100px"></pre>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- PHASE 2 ----------------------------------------------------------->
  <div class="card">
    <div class="pill">Phase 2 — Prediction</div>
    <div class="tiny" style="margin-top:6px;">No JP anchoring. Enter the **prediction draw date** (the date you plan to buy), then load Phase-2 histories (here, the 2nd-newest JP date becomes the first line of each 20-row block).</div>

    <!-- Phase 2 dates -->
    <div class="grid grid-3" style="margin-top:10px;">
      <div>
        <div class="tiny">Mega Millions — draw date</div>
        <input id="p2_mmDraw" type="text" placeholder="MM/DD/YYYY" />
      </div>
      <div>
        <div class="tiny">Powerball — draw date</div>
        <input id="p2_pbDraw" type="text" placeholder="MM/DD/YYYY" />
      </div>
      <div>
        <div class="tiny">IL Lotto — draw date</div>
        <input id="p2_ilDraw" type="text" placeholder="MM/DD/YYYY" />
      </div>
    </div>

    <!-- Phase 2 history loaders (use 2nd-newest start) -->
    <div class="grid grid-3" style="margin-top:12px;">
      <div class="card">
        <div class="tiny">Phase-2 HIST_MM_BLOB start (2nd-newest JP date)</div>
        <div class="inline" style="gap:6px;">
          <input id="p2_mmHistDate" type="text" placeholder="MM/DD/YYYY" />
          <button id="p2_mmLoad20" class="btn">Load 20</button>
        </div>
        <textarea id="P2_HIST_MM_BLOB" class="mono" rows="7"></textarea>
      </div>
      <div class="card">
        <div class="tiny">Phase-2 HIST_PB_BLOB start (2nd-newest JP date)</div>
        <div class="inline" style="gap:6px;">
          <input id="p2_pbHistDate" type="text" placeholder="MM/DD/YYYY" />
          <button id="p2_pbLoad20" class="btn">Load 20</button>
        </div>
        <textarea id="P2_HIST_PB_BLOB" class="mono" rows="7"></textarea>
      </div>
      <div class="card">
        <div class="tiny">Phase-2 HIST_IL (JP/M1/M2) start (2nd-newest JP date)</div>
        <div class="grid grid-3" style="gap:6px;">
          <div>
            <div class="tiny">JP</div>
            <div class="inline" style="gap:6px;">
              <input id="p2_ilJPHistDate" type="text" placeholder="MM/DD/YYYY" />
              <button id="p2_ilJPLoad20" class="btn">Load 20</button>
            </div>
            <textarea id="P2_HIST_IL_JP_BLOB" class="mono" rows="5"></textarea>
          </div>
          <div>
            <div class="tiny">M1</div>
            <div class="inline" style="gap:6px;">
              <input id="p2_ilM1HistDate" type="text" placeholder="MM/DD/YYYY" />
              <button id="p2_ilM1Load20" class="btn">Load 20</button>
            </div>
            <textarea id="P2_HIST_IL_M1_BLOB" class="mono" rows="5"></textarea>
          </div>
          <div>
            <div class="tiny">M2</div>
            <div class="inline" style="gap:6px;">
              <input id="p2_ilM2HistDate" type="text" placeholder="MM/DD/YYYY" />
              <button id="p2_ilM2Load20" class="btn">Load 20</button>
            </div>
            <textarea id="P2_HIST_IL_M2_BLOB" class="mono" rows="5"></textarea>
          </div>
        </div>
      </div>
    </div>

    <!-- RUN PHASE 2 -->
    <div class="inline" style="margin-top:12px;">
      <button id="runPhase2" class="btn primary">Run Phase 2</button>
      <span id="phase2Note" class="tiny">Uses FEED_* and Phase-2 histories only (no JP).</span>
    </div>

    <!-- Phase 2 results (3 columns; no hit scoring, show diversity/meta) -->
    <div class="grid grid-3" style="margin-top:12px;">
      <div class="card">
        <div class="inline"><span class="pill">Mega Millions — 50 rows</span><span id="p2_mmMeta" class="tiny right"></span></div>
        <ol id="p2_mmBatch" class="batch mono"></ol>
      </div>
      <div class="card">
        <div class="inline"><span class="pill">Powerball — 50 rows</span><span id="p2_pbMeta" class="tiny right"></span></div>
        <ol id="p2_pbBatch" class="batch mono"></ol>
      </div>
      <div class="card">
        <div class="inline"><span class="pill">IL Lotto — 50 rows</span><span id="p2_ilMeta" class="tiny right"></span></div>
        <ol id="p2_ilBatch" class="batch mono"></ol>
      </div>
    </div>
  </div>

  <script src="/static/app.js"></script>
</body>
</html>
